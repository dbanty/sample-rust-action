name: sample-rust-action
description: An example GitHub Action written in Rust, generated from [dbanty/rust-github-action-template](https://github.com/dbanty/rust-github-action-template). You can either use this GitHub template and customize it yourself, or `cargo generate dbanty/rust-github-action-template` to create a new repo from this template. Any issues should be opened in the upstream template.
author: Dylan Anthony <dbanty@users.noreply.github.com>
inputs:
  error:
    description: 'The error message to display, if any'
    required: false
    default: ''
outputs:
  error:
    value: ${{ steps.run.outputs.error }}
    description: 'The description of any error that occurred'
runs:
  using: 'composite'
  steps:
    - name: Get Action Version
      id: get_action_version
      shell: pwsh
      run: Write-Output "version=$(Split-Path -Leaf ${{ github.action_path }})" >> $Env:GITHUB_OUTPUT

    - name: Set Archive Name (Linux)
      if: runner.os == 'Linux'
      shell: bash
      run: echo "archive_name=x86_64-unknown-linux-musl" >> $GITHUB_ENV

    - name: Set Archive Name (MacOS)
      if: runner.os == 'macOS'
      shell: bash
      run: echo "archive_name=x86_64-apple-darwin" >> $GITHUB_ENV

    - name: Set Archive Name (Windows)
      if: runner.os == 'Windows'
      shell: bash
      run: echo "archive_name=x86_64-pc-windows-msvc" >> $GITHUB_ENV

    - name: Download Action
      shell: pwsh
      run: |
        Invoke-WebRequest -Uri https://github.com/${{ github.action_repository }}/releases/download/${{ steps.get_action_version.outputs.version }}/${{ env.archive_name }}.tgz -OutFile archive.tgz
        tar -xzf archive.tgz

    - name: Run Action
      shell: bash
      run: ./archive/${{ env.archive_name }}/${{ env.binary_name }} ${{ github.event.inputs.error }}
